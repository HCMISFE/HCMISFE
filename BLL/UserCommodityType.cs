
// Generated by MyGeneration Version # (1.2.0.7)

using System;
using DAL;
using System.Data;

namespace BLL
{
    public class UserCommodityType : _UserCommodityType
    {
        public UserCommodityType()
        {

        }
        public void DeleteAllTypeForUser(int userid)
        {
            this.FlushData();
            this.Where.WhereClauseReset();
            this.Where.UserID.Value = userid;
            this.Query.Load();
            foreach (DataRowView dv in this.DataTable.DefaultView)
            {
                this.LoadByPrimaryKey(Convert.ToInt32(dv["ID"])); 
                    this.MarkAsDeleted();
                    this.Save(); 
            }
        }
        public DataTable GetUserCommodityType(int userid)
        {
            this.FlushData();
            this.LoadFromRawSql(String.Format(@"SELECT   ty.ID, ty.Name
                                                FROM     vwGetUsers vu
                                                JOIN dbo.UserCommodityType ut ON ut.UserID = vu.id
                                                JOIN dbo.[Type] ty ON ty.id = ut.typeid
                                                WHERE ut.UserID =  {0}",userid));
            return this.DataTable;
        }
        public bool CheckIfExists(int userid, int comid)
        {
            bool exist = false;
            this.FlushData();
            this.Where.WhereClauseReset();
            this.Where.UserID.Value = userid;
            this.Where.TypeID.Conjuction = MyGeneration.dOOdads.WhereParameter.Conj.And;
            this.Where.TypeID.Value = comid;
            this.Query.Load();
            if (this.DataTable.Rows.Count > 0)
                exist = true;

            return exist;
        }
    }
}
